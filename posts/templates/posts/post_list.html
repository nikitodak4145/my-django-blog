<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìù –ú–æ–π –±–ª–æ–≥</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            padding-top: 20px;
        }
        .container {
            max-width: 900px;
        }
        .post-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .post-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .post-title {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        .read-more {
            display: inline-block;
            padding: 8px 16px;
            background: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }
        .read-more:hover {
            background: #2980b9;
            color: white;
        }
        .search-box {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .footer {
            margin-top: 40px;
            padding: 20px;
            text-align: center;
            color: #7f8c8d;
            border-top: 1px solid #eee;
        }
        .js-test {
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            background: #ecf0f1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <i class="bi bi-journal-text"></i> –ú–æ–π –ë–ª–æ–≥
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/">
                                <i class="bi bi-house"></i> –ì–ª–∞–≤–Ω–∞—è
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/admin/" target="_blank">
                                <i class="bi bi-gear"></i> –ê–¥–º–∏–Ω–∫–∞
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/api/posts/">
                                <i class="bi bi-code-slash"></i> API
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- –ü–ê–ù–ï–õ–¨ –°–¢–ê–¢–ò–°–¢–ò–ö–ò -->
        <div class="container mb-4">
            <div class="card">
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <h3 class="text-primary">{{ total_views|default:0 }}</h3>
                            <p class="text-muted">–í—Å–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</p>
                        </div>
                        <div class="col-md-4">
                            <h3 class="text-success">{{ total_posts|default:0 }}</h3>
                            <p class="text-muted">–°—Ç–∞—Ç–µ–π</p>
                        </div>
                        <div class="col-md-4">
                            <h3 class="text-warning">{{ total_comments|default:0 }}</h3>
                            <p class="text-muted">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–û–ò–°–ö -->
        <div class="search-box">
            <h4>üîç –ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—å—è–º</h4>
            <form method="get" action="">
                <div class="input-group">
                    <input type="text" name="q" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å..." 
                           value="{{ request.GET.q|default:'' }}">
                    <button class="btn btn-primary" type="submit">–ò—Å–∫–∞—Ç—å</button>
                </div>
            </form>
            {% if request.GET.q %}
                <p class="mt-2">
                    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É: "<strong>{{ request.GET.q }}</strong>"
                    <a href="?" class="btn btn-sm btn-outline-secondary ms-2">–û—á–∏—Å—Ç–∏—Ç—å</a>
                </p>
            {% endif %}
        </div>

        <!-- –°–¢–ê–¢–¨–ò -->
         <span class="badge bg-secondary me-1 post-views-{{ post.id }}">
    <i class="bi bi-eye"></i> {{ post.views|default:0 }}
</span>
        <div class="row">
            {% for post in posts %}
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">{{ post.title }}</h5>
                        
                        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–¢–ê–¢–¨–ò -->
                        <div class="stats mb-2">
                            <span class="badge bg-secondary me-1">
                                <i class="bi bi-eye"></i> {{ post.views|default:0 }}
                            </span>
                            <span class="badge bg-info me-1">
                                <i class="bi bi-chat"></i> {{ post.comments.count }}
                            </span>
                            <span class="badge bg-light text-dark">
                                <i class="bi bi-calendar"></i> {{ post.created_at|date:"d.m.Y" }}
                            </span>
                        </div>
                        
                        <p class="card-text">
                            {{ post.content|truncatewords:30 }}
                        </p>
                        
                        <!-- –°–°–´–õ–ö–ê –° –ü–†–ê–í–ò–õ–¨–ù–´–ú ID -->
                        <a href="/post/{{ post.id }}/" class="btn btn-primary">
                            –ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- –ü–ê–ì–ò–ù–ê–¶–ò–Ø -->
        {% if page_obj.has_other_pages %}
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                {% if page_obj.has_previous %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">‚Üê –ù–∞–∑–∞–¥</a>
                    </li>
                {% endif %}
                
                <li class="page-item active">
                    <span class="page-link">–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>
                </li>
                
                {% if page_obj.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}

        <!-- JAVASCRIPT –¢–ï–°–¢ -->
        <div class="js-test">
            <h4>üéØ JavaScript OOP –¢–µ—Å—Ç</h4>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã JavaScript –∏ –û–û–ü –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</p>
            
            <button onclick="testJavaScript()" class="btn btn-success me-2">
                üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç JS
            </button>
            
            <button onclick="addTestPost()" class="btn btn-warning">
                üìù –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç–∞—Ç—å—é
            </button>
            
            <div id="js-result" class="mt-3 p-3 bg-white rounded"></div>
        </div>

        <!-- –ü–û–î–í–ê–õ -->
        <div class="footer">
            <p>–ú–æ–π –±–ª–æ–≥ ¬© {% now "Y" %} | –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {{ posts.count }} | 
               <a href="/admin/">–ê–¥–º–∏–Ω–∫–∞</a> | 
               <a href="/api/posts/">API</a>
            </p>
        </div>
    </div>

    <!-- –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï JAVASCRIPT -->
    <script src="/static/js/blog.js"></script>
    
    <!-- –í–°–¢–†–û–ï–ù–ù–´–ô JS –î–õ–Ø –¢–ï–°–¢–ê -->
    <script>
    // –ü–†–û–°–¢–û–ô –ö–õ–ê–°–° –î–õ–Ø –¢–ï–°–¢–ê
    class TestBlog {
        constructor() {
            this.posts = [];
            this.nextId = 1;
            console.log("‚úÖ TestBlog —Å–æ–∑–¥–∞–Ω");
        }
        
        addPost(title, text) {
            const post = {
                id: this.nextId,
                title: title,
                text: text,
                time: new Date().toLocaleTimeString()
            };
            this.posts.push(post);
            this.nextId++;
            
            console.log(`üìù –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç—å—è: "${title}"`);
            return post;
        }
        
        showPosts() {
            console.log("=== –í—Å–µ —Å—Ç–∞—Ç—å–∏ –≤ JS ===");
            this.posts.forEach(p => {
                console.log(`#${p.id}: ${p.title} (${p.time})`);
            });
            return this.posts;
        }
    }
    
    // –°–û–ó–î–ê–Å–ú –û–ë–™–ï–ö–¢
    window.testBlog = new TestBlog();
    
    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–ù–û–ü–û–ö
    function testJavaScript() {
        console.clear();
        console.log("üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç JavaScript...");
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏
        testBlog.addPost("–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç—å—è 1", "–≠—Ç–æ –ø–µ—Ä–≤–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç—å—è");
        testBlog.addPost("–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç—å—è 2", "–≠—Ç–æ –≤—Ç–æ—Ä–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç—å—è");
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –∫–æ–Ω—Å–æ–ª–∏
        testBlog.showPosts();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        const resultDiv = document.getElementById('js-result');
        const posts = testBlog.posts;
        
        let html = '<h5>‚úÖ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω! –°—Ç–∞—Ç—å–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã:</h5>';
        posts.forEach(post => {
            html += `
                <div class="border p-2 mb-2">
                    <strong>${post.title}</strong><br>
                    <small>ID: ${post.id}, –í—Ä–µ–º—è: ${post.time}</small>
                </div>
            `;
        });
        html += `<p><em>–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–∞–∫–∂–µ –∫–æ–Ω—Å–æ–ª—å (F12 ‚Üí Console)</em></p>`;
        
        resultDiv.innerHTML = html;
        
        alert("‚úÖ JavaScript —Ä–∞–±–æ—Ç–∞–µ—Ç!\n\n–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ:\n1. –°–æ–æ–±—â–µ–Ω–∏–µ –≤—ã—à–µ\n2. –ö–æ–Ω—Å–æ–ª—å (F12 ‚Üí Console)\n3. –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∏–∂–µ");
    }
    
    function addTestPost() {
        const num = Math.floor(Math.random() * 100);
        const post = testBlog.addPost(
            `–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç—å—è #${num}`, 
            `–¢–µ–∫—Å—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –≤ ${new Date().toLocaleTimeString()}`
        );
        
        const resultDiv = document.getElementById('js-result');
        resultDiv.innerHTML = `
            <div class="alert alert-success">
                <h5>‚úÖ –°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!</h5>
                <p><strong>${post.title}</strong></p>
                <p><small>ID: ${post.id} | –í—Ä–µ–º—è: ${post.time}</small></p>
                <p>–í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π –≤ JS: ${testBlog.posts.length}</p>
            </div>
        `;
        
        console.log("–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç–∞—Ç—å—è:", post);
    }
    
    // –ê–í–¢–û–¢–ï–°–¢ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
    document.addEventListener('DOMContentLoaded', function() {
        console.log("üìÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, JavaScript —Ä–∞–±–æ—Ç–∞–µ—Ç!");
        testBlog.addPost("–ê–≤—Ç–æ-—Å—Ç–∞—Ç—å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ", "–≠—Ç–∞ —Å—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏");
    });
    </script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>